{"is_source_file": true, "format": "Python", "description": "Unit tests for the FirestoreMemoryDb class, testing its initialization, CRUD operations, existence checks, and error handling.", "external_files": ["agno.memory.v2.db.firestore", "agno.memory.v2.db.schema", "google.api_core.exceptions"], "external_methods": ["patch", "MagicMock", "pytest", "FirestoreMemoryDb", "MemoryRow"], "published": [], "classes": [], "methods": [{"name": "mock_firestore_client", "description": "Fixture that creates a mocked Firestore client and collection."}, {"name": "memory_db", "description": "Fixture that creates a FirestoreMemoryDb instance with mocked components."}, {"name": "test_initialization", "description": "Tests the initialization of FirestoreMemoryDb with correct parameters."}, {"name": "test_authentication_error", "description": "Tests handling of authentication errors during client creation."}, {"name": "test_get_user_collection", "description": "Tests retrieval of user-specific collection."}, {"name": "test_read_memories", "description": "Tests reading memories from Firestore, including filtering by user_id."}, {"name": "test_upsert_memory", "description": "Tests inserting or updating a memory document."}, {"name": "test_memory_exists", "description": "Checks whether a memory exists in Firestore."}, {"name": "test_delete_memory", "description": "Tests deletion of a memory document."}, {"name": "test_clear", "description": "Tests clearing all documents in the collection."}, {"name": "test_table_exists", "description": "Checks if the collection exists."}, {"name": "test_recursive_deletion", "description": "Tests recursive deletion of documents with subcollections."}, {"name": "test_error_handling", "description": "Tests error handling in various Firestore operations."}], "calls": ["agno.memory.v2.db.firestore.Client", "pytest.raises", "mock_client.assert_called_once_with", "mock_client.return_value", "mock_db.collection", "mock_user_collection.order_by", "mock_query.stream", "mock_doc1.to_dict", "mock_doc2.to_dict", "MemoryRow", "db.get_user_collection", "db.read_memories", "db.upsert_memory", "db.memory_exists", "db.delete_memory", "db.clear", "db.table_exists", "db._delete_document"], "search-terms": ["FirestoreMemoryDb", "unit tests", "memory", "Firestore", "test_memory_firestore", "schema", "MemoryRow", "Firestore client mock", "collection", "CRUD", "error handling"], "state": 2, "file_id": 596, "knowledge_revision": 2838, "git_revision": "502396235dd9bbbde83b8de7f4821d124064144c", "ctags": [], "filename": "libs/agno/tests/unit/memory/test_memory_firestore.py", "hash": "ce13a1d9da7c6073912cc6845290f054", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"2838": "502396235dd9bbbde83b8de7f4821d124064144c"}]}