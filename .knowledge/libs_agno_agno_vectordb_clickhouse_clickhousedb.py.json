{"is_source_file": true, "format": "Python", "description": "This file defines a Python class 'Clickhouse' that implements a vector database interface for Clickhouse, including methods for creating, checking existence, inserting, searching, and deleting tables and documents, with support for asynchronous operations.", "external_files": ["clickhouse_connect", "agno.vectordb.clickhouse.index", "agno.document", "agno.embedder", "agno.utils.log", "agno.vectordb.base", "agno.vectordb.distance"], "external_methods": ["clickhouse_connect.get_client", "clickhouse_connect.get_async_client", "log_debug", "log_info", "logger.error"], "published": ["Clickhouse"], "classes": [{"name": "Clickhouse", "description": "A class implementing a vector database interface for Clickhouse, supporting creation, existence checks, insertion, search, and deletion of documents, with both sync and async methods."}], "methods": [{"name": "__init__", "description": "Initializes the Clickhouse database connection with parameters for host, credentials, database, and optional embedder and index."}, {"name": "_ensure_async_client", "description": "Ensures that the async client is initialized, creating it if necessary."}, {"name": "_get_base_parameters", "description": "Returns base parameters for database queries, such as table and database names."}, {"name": "table_exists", "description": "Checks if the specified table exists in the database."}, {"name": "async_table_exists", "description": "Asynchronously checks if the specified table exists."}, {"name": "create", "description": "Creates the database and table if they do not exist, including setting up the index."}, {"name": "async_create", "description": "Asynchronously creates the database and table."}, {"name": "doc_exists", "description": "Checks if a specific document exists based on its content hash."}, {"name": "async_doc_exists", "description": "Asynchronously checks if a specific document exists."}, {"name": "name_exists", "description": "Checks if a document with a given name exists."}, {"name": "async_name_exists", "description": "Asynchronously checks if a document with a given name exists."}, {"name": "id_exists", "description": "Checks if a document with a specific ID exists."}, {"name": "insert", "description": "Inserts a list of documents into the database synchronously."}, {"name": "async_insert", "description": "Inserts documents asynchronously."}, {"name": "upsert_available", "description": "Indicates that upsert operation is supported."}, {"name": "upsert", "description": "Performs an upsert (insert or update) of documents."}, {"name": "async_upsert", "description": "Performs an asynchronous upsert of documents."}, {"name": "search", "description": "Performs a vector similarity search synchronously."}, {"name": "async_search", "description": "Performs a vector similarity search asynchronously."}, {"name": "drop", "description": "Deletes the table if it exists."}, {"name": "async_drop", "description": "Asynchronously deletes the table."}, {"name": "exists", "description": "Checks if the table exists."}, {"name": "async_exists", "description": "Asynchronously checks if the table exists."}, {"name": "get_count", "description": "Returns the total number of documents in the table."}, {"name": "optimize", "description": "Placeholder for optimization; currently does nothing."}, {"name": "delete", "description": "Deletes all data from the table."}], "calls": ["clickhouse_connect.get_client", "clickhouse_connect.get_async_client", "log_debug", "log_info", "logger.error", "self.client.command", "self.client.query", "self.async_client.query", "self.async_client.insert", "self.client.insert", "self.client.command", "self.async_client.command"], "search-terms": ["Clickhouse", "vector database", "async client", "vector similarity index", "HNSW", "create database", "vector search", "JSON storage", "document embedding", "content hash"], "state": 2, "file_id": 575, "knowledge_revision": 2843, "git_revision": "65b51199867b9c95a09bfe7c4c91e56b8126e675", "ctags": [], "filename": "libs/agno/agno/vectordb/clickhouse/clickhousedb.py", "hash": "0db423e6c4da7fda96a88ee9ae20f3a7", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"2843": "65b51199867b9c95a09bfe7c4c91e56b8126e675"}]}