{"is_source_file": true, "format": "Python", "description": "This file defines classes and functions related to handling tool calls and responses within the Ollama model integration, including parsing responses, managing tool call content, and generating prompts for tool invocation.", "external_files": ["agno.models.message", "agno.models.ollama.chat", "agno.models.response", "agno.tools.function", "agno.utils.log", "agno.utils.timer", "agno.utils.tools"], "external_methods": ["extract_tool_call_from_string", "remove_tool_calls_from_string"], "published": ["OllamaResponseUsage", "ToolCall", "OllamaTools", "_parse_tool_calls_from_content"], "classes": [{"name": "OllamaResponseUsage", "description": "Data class for tracking token usage and durations related to Ollama responses."}, {"name": "ToolCall", "description": "Data class for managing tool call content, counters, and response state during response parsing."}, {"name": "OllamaTools", "description": "A class extending Ollama, implementing response parsing, prompt generation, and response streaming for the Ollama model with XML-based tool call handling."}], "methods": [{"name": "request_kwargs", "description": "Returns API request parameters based on class attributes."}, {"name": "parse_provider_response", "description": "Parses the ChatResponse from the provider, extracting role, content, tool calls, and response usage."}, {"name": "create_function_call_result", "description": "Creates a Message object representing the result of a function call."}, {"name": "format_function_call_results", "description": "Formats and appends function call result messages to the message list."}, {"name": "_prepare_function_calls", "description": "Prepares function calls based on the assistant message and model response."}, {"name": "process_response_stream", "description": "Processes streaming responses synchronously, yielding ModelResponse objects."}, {"name": "aprocess_response_stream", "description": "Asynchronously processes streaming responses, yielding ModelResponse objects."}, {"name": "parse_provider_response_delta", "description": "Parses individual response deltas, managing tool call content and detecting completion."}, {"name": "get_instructions_to_generate_tool_calls", "description": "Provides instructions for generating tool calls."}, {"name": "get_tool_call_prompt", "description": "Generates the prompt used to instruct the model on tool call usage."}, {"name": "get_system_message_for_model", "description": "Returns the system message prompt for the model, typically the tool call prompt."}, {"name": "get_instructions_for_model", "description": "Returns instructions for the model regarding tool call generation."}], "calls": ["response.get", "response_message.get", "extract_tool_call_from_string", "remove_tool_calls_from_string", "json.loads", "json.dumps", "response.get", "response_message.get", "response_delta.get", "log_warning", "self.invoke_stream", "self.ainvoke_stream", "self._populate_stream_data_and_assistant_message", "assistant_message.get_content_string", "self.get_function_calls_to_run"], "search-terms": ["Ollama", "tool calls", "XML tags", "response parsing", "streaming response", "response delta", "function call", "prompt generation", "response usage", "response content"], "state": 2, "file_id": 255, "knowledge_revision": 2544, "git_revision": "7be3f1b991ce63c06a4f1f5b80ebfaa88aa24e69", "ctags": [], "filename": "libs/agno/agno/models/ollama/tools.py", "hash": "be50803f5651768c8e01e1af62c71b57", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"2544": "7be3f1b991ce63c06a4f1f5b80ebfaa88aa24e69"}]}