{"is_source_file": true, "format": "Python", "description": "This file contains integration tests for the Perplexity model within the agno project, testing various functionalities such as basic responses, streaming, asynchronous calls, memory handling, structured response modeling, history management, and citations.", "external_files": ["pytest", "pydantic", "agno.agent", "agno.models.perplexity", "agno.storage.sqlite"], "external_methods": ["pytest.mark.asyncio", "pytest.mark.skip", "pytest", "pydantic.BaseModel", "pydantic.Field", "agno.agent.Agent", "agno.agent.RunResponse", "agno.models.perplexity.Perplexity", "agno.storage.sqlite.SqliteStorage"], "published": [], "classes": [{"name": "MovieScript", "description": "A Pydantic model for structured movie script data, used in a test for structured output responses."}], "methods": [{"name": "_assert_metrics", "description": "A helper function to assert that the metrics in a RunResponse contain positive token counts and that total tokens equal the sum of input and output tokens."}, {"name": "test_basic", "description": "Tests a basic synchronous interaction with the Perplexity agent, verifying response content, message roles, and metrics."}, {"name": "test_basic_stream", "description": "Tests streaming responses from the agent, ensuring it is iterable and responses contain content."}, {"name": "test_async_basic", "description": "Asynchronous test for a basic interaction, verifying response content and message roles."}, {"name": "test_async_basic_stream", "description": "Asynchronous test for streaming responses, verifying content is received."}, {"name": "test_with_memory", "description": "Tests the agent's memory feature, ensuring it retains context across multiple interactions."}, {"name": "test_response_model", "description": "Tests structured output response modeling with a custom Pydantic class, verifying the response content is an instance of the model and fields are populated."}, {"name": "test_history", "description": "Tests the history feature with SQLite storage, verifying message count increases with each interaction."}, {"name": "test_citations", "description": "Verifies that responses include citations with URLs."}, {"name": "test_citations_stream", "description": "Verifies citations are present in streaming responses."}], "calls": ["agno.agent.Agent.run", "agno.agent.Agent.arun", "agno.agent.Agent.get_messages_for_session", "agno.agent.Agent.run_response", "agno.models.perplexity.Perplexity", "agno.storage.sqlite.SqliteStorage"], "search-terms": ["Perplexity", "structured response", "memory", "citations", "streaming", "asyncio", "integration tests"], "state": 2, "file_id": 768, "knowledge_revision": 3011, "git_revision": "777260577abc1ec1fbdfa141f65351510b5775ee", "ctags": [], "filename": "libs/agno/tests/integration/models/perplexity/test_basic.py", "hash": "977602d0d41f7bcd53ac9d12f0ff49fb", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"3011": "777260577abc1ec1fbdfa141f65351510b5775ee"}]}