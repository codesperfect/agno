{"is_source_file": true, "format": "Python", "description": "This file contains unit tests for the GeminiTools class in the agno.tools.models.gemini module. It uses pytest and unittest.mock to test initialization, image and video generation, and error handling scenarios.", "external_files": ["agno.agent", "agno.media", "agno.tools.models.gemini"], "external_methods": ["pytest.raises", "patch", "MagicMock", "UUID", "base64.b64encode"], "published": [], "classes": [], "methods": [{"name": "mock_agent", "description": "Fixture that creates a mock Agent with an add_image method."}, {"name": "mock_client", "description": "Fixture that creates a mock client object."}, {"name": "mock_gemini_tools", "description": "Fixture that creates a GeminiTools instance with a mocked client and environment."}, {"name": "mock_successful_response", "description": "Fixture that creates a mock response with generated image bytes."}, {"name": "mock_failed_response_no_bytes", "description": "Fixture that creates a mock response with no generated images."}, {"name": "test_gemini_tools_init_with_api_key_arg", "description": "Tests GeminiTools initialization with an API key provided directly."}, {"name": "test_gemini_tools_init_with_env_var", "description": "Tests GeminiTools initialization with API key from environment variable."}, {"name": "test_gemini_tools_init_no_api_key", "description": "Tests that initialization raises ValueError if no API key is found."}, {"name": "test_gemini_tools_init_client_creation_fails", "description": "Tests that initialization raises ValueError if client creation fails."}, {"name": "test_generate_image_success", "description": "Tests successful image generation and addition to agent."}, {"name": "test_generate_image_api_error", "description": "Tests handling of API exception during image generation."}, {"name": "test_generate_image_no_image_bytes", "description": "Tests handling when API response lacks image bytes."}, {"name": "test_generate_video_requires_vertexai", "description": "Tests that video generation is blocked if vertexai mode is disabled."}, {"name": "mock_video_operation", "description": "Fixture for a mock completed video generation operation."}, {"name": "test_generate_video_success", "description": "Tests successful video generation and addition to agent."}, {"name": "test_generate_video_exception", "description": "Tests handling of exception during video generation."}, {"name": "test_empty_response_handling", "description": "Ensures empty image responses are handled correctly."}], "search-terms": ["GeminiTools", "unit tests", "image generation", "video generation", "mock responses", "pytest", "API error handling", "environment variable", "client creation failure"], "state": 2, "file_id": 634, "knowledge_revision": 2890, "git_revision": "de4f484df0a97ba767f52dcde416048a0cdfa54e", "ctags": [], "filename": "libs/agno/tests/unit/tools/models/test_gemini.py", "hash": "11261cca1e115197d89253543d046f8f", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"2890": "de4f484df0a97ba767f52dcde416048a0cdfa54e"}]}