{"is_source_file": true, "format": "Python", "description": "This file defines a Python class 'AwsBedrock' that models an AWS Bedrock API client, including methods for configuration, message formatting, invoking API calls synchronously and via streaming, and response parsing. It integrates with boto3 for AWS interactions and handles complex message and response processing for a language model interface.", "external_files": ["boto3", "botocore.exceptions", "agno.exceptions", "agno.models.base", "agno.models.message", "agno.models.response", "agno.utils.log"], "external_methods": ["getenv", "log_debug", "log_error", "log_warning", "AgnoError", "ModelProviderError", "_add_usage_metrics_to_assistant_message"], "published": ["AwsBedrock"], "classes": [{"name": "AwsBedrock", "description": "A class representing an AWS Bedrock model client, capable of configuring AWS credentials, formatting messages, invoking the model synchronously and via streaming, and parsing responses."}], "methods": [{"name": "get_client", "description": "Returns the AWS Bedrock client, initializing it if necessary based on session or environment variables."}, {"name": "_format_tools_for_request", "description": "Formats a list of tools into the request schema expected by the API."}, {"name": "_get_inference_config", "description": "Constructs the inference configuration dictionary based on class attributes."}, {"name": "_format_messages", "description": "Converts a list of Message objects into the API request format, handling special message types and media."}, {"name": "invoke", "description": "Performs a synchronous API call to the model with formatted messages and optional tools."}, {"name": "invoke_stream", "description": "Performs a streaming API call to the model, yielding partial responses."}, {"name": "format_function_call_results", "description": "Handles the results of function calls, appending them to the message list."}, {"name": "parse_provider_response", "description": "Parses the API response into a ModelResponse object, extracting message content, tool calls, and usage."}, {"name": "process_response_stream", "description": "Processes streaming responses, handling tool use, content accumulation, and response metrics."}, {"name": "parse_provider_response_delta", "description": "Placeholder for parsing individual response delta chunks in streaming mode."}, {"name": "ainvoke", "description": "Async invocation method, not implemented."}, {"name": "ainvoke_stream", "description": "Async streaming invocation method, not implemented."}], "calls": ["getenv", "log_debug", "log_error", "log_warning", "self.session.client", "self.get_client().converse", "self.get_client().converse_stream", "_add_usage_metrics_to_assistant_message"], "search-terms": ["AwsBedrock", "boto3", "streaming", "message formatting", "AWS credentials", "model response parsing", "invoke", "invoke_stream"], "state": 2, "file_id": 237, "knowledge_revision": 2518, "git_revision": "69e8f9dc474e69f2d3863442c4c1c6824ca37f08", "ctags": [], "filename": "libs/agno/agno/models/aws/bedrock.py", "hash": "8fd4e23aab18993913c2757b627f1d4f", "format-version": 4, "code-base-name": "https://github.com/codesperfect/agno.git:main", "revision_history": [{"2518": "69e8f9dc474e69f2d3863442c4c1c6824ca37f08"}]}